{% extends 'base.html' %}

{% block title %}
  账户设置
{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}" />
{% endblock %}

{% block content %}
  <div class="dashboard-container">
    <!-- 主内容区 -->
    <main class="main-content" id="mainContent">
      <!-- 顶栏 -->
      <header class="top-navbar">
        <div class="navbar-container">
          <div class="left-section">
            <div class="project-logo" id="projectLogo">
              <div class="logo-circle">Z</div>
              <span>ZZH-Tool</span>
            </div>
          </div>

          <div class="right-section">
            <div class="user-dropdown" id="userDropdown">
              <div class="user-info" id="userInfo">
                <!-- 修改这里：根据头像信息显示头像 -->
                {% if user_info.avatar %}
                  <img src="{{ url_for('get_avatar', filename=user_info.avatar) }}" alt="头像" class="user-avatar-img" />
                {% else %}
                  <div class="user-avatar-text">{{ user_info.username|first|upper }}</div>
                {% endif %}
                <span>{{ user_info.username }}</span>
                <i class="fas fa-chevron-down"></i>
              </div>

              <div class="dropdown-menu" id="dropdownMenu">
                <div class="dropdown-header">
                  <!-- 修改这里：根据头像信息显示头像 -->
                  {% if user_info.avatar %}
                    <img src="{{ url_for('get_avatar', filename=user_info.avatar) }}" alt="头像" class="dropdown-avatar-img" />
                  {% else %}
                    <div class="dropdown-avatar-text">{{ user_info.username|first|upper }}</div>
                  {% endif %}
                  <div>
                    <h3>{{ user_info.username }}</h3>
                    <p>{{ user_info.email }}</p>
                  </div>
                </div>

                <div class="dropdown-divider"></div>

                <a href="/profile" class="dropdown-item">
                  <i class="fas fa-user"></i>
                  <span>个人资料</span>
                </a>

                <a href="/account_settings" class="dropdown-item">
                  <i class="fas fa-cog"></i>
                  <span>账户设置</span>
                </a>

                <a href="/security_settings" class="dropdown-item">
                  <i class="fas fa-shield-alt"></i>
                  <span>安全设置</span>
                </a>

                <div class="dropdown-divider"></div>

                <a href="/logout" class="dropdown-item logout">
                  <i class="fas fa-sign-out-alt"></i>
                  <span>退出登录</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- 账户设置内容 -->
      <div class="dashboard-content">
        <div class="profile-container">
          <div class="section-card">
            <div class="section-header">
              <i class="fas fa-cog"></i>
              <h2>账户设置</h2>
            </div>

            <form id="accountForm">
              <div class="form-group">
                <label for="username">用户名</label>
                <input type="text" id="username" class="form-control" value="{{ user_info.username }}" disabled />
                <small class="text-muted">用户名在注册后不可更改</small>
              </div>

              <div class="form-group">
                <label for="email">电子邮箱</label>
                <input type="email" id="email" class="form-control" value="{{ user_info.email }}" />
              </div>

              <div class="form-group">
                <label for="currentPassword">当前密码</label>
                <input type="password" id="currentPassword" class="form-control" placeholder="请输入当前密码以验证身份" />
              </div>

              <div class="form-actions">
                <button type="reset" class="btn btn-secondary"><i class="fas fa-times"></i> 取消</button>
                <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> 更新账户信息</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="{{ url_for('static', filename='js/profile.js') }}"></script>
{% endblock %}

